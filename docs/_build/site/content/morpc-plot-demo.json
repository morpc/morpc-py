{"version":2,"kind":"Notebook","sha256":"119be28d8050072f97f425fb27b596bd5057acfa8e7c8ead1ee8b072584bfe74","slug":"morpc-plot-demo","location":"/morpc-plot-demo.ipynb","dependencies":[],"frontmatter":{"title":"Demo for morpc.plot","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"morpc_env","language":"python"},"github":"https://github.com/morpc/morpc-py","exports":[{"format":"ipynb","filename":"morpc-plot-demo.ipynb","url":"/morpc-plot-demo-b36668a8c86a325ab07b85eb02b3b00c.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot from Resource","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w0OcY2EWA2"}],"identifier":"plot-from-resource","label":"Plot from Resource","html_id":"plot-from-resource","implicit":true,"key":"rfB2zDuYo1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Plot a graph or chart from a frictionless resource based on schema and data types.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"y3KFLL7JXZ"}],"key":"I6PkkHUr27"}],"key":"Kd1ejZ6OVv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import morpc","key":"aydhGWBh7U"},{"type":"output","id":"RL7Is72YpwLj_8oVDGobC","data":[],"key":"QXjbYLylD9"}],"key":"QpHfOKJkoA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Build a sample resource file.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YCVna1xWPD"}],"identifier":"build-a-sample-resource-file","label":"Build a sample resource file.","html_id":"build-a-sample-resource-file","implicit":true,"key":"MEmHx2XPBF"}],"key":"b85WVDgmcw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df, resource, schema = morpc.frictionless.load_data('../../morpc-pop-collect/output_data/morpc-pop-collect.resource.yaml')","key":"K1Px1Ng3e8"},{"type":"output","id":"GhvxT-K4UeTvVaY8w3Vr8","data":[],"key":"BYRHCD50VR"}],"key":"V6BMdUJmMw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df = df.sort_values('VINTAGE_PERIOD', ascending=False).groupby(['GEOIDFQ', 'REFERENCE_PERIOD']).head(1).sort_values('REFERENCE_PERIOD')","key":"m1NcP8Xj25"},{"type":"output","id":"786W1QO71z9h30eUObN_b","data":[],"key":"gDcyzl2hu1"}],"key":"xxuzeAuATD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grouped = df.groupby('GEOIDFQ')","key":"x7hpdggjJ5"},{"type":"output","id":"mxH2q7lEVA1dva-8ZvMzx","data":[],"key":"D9HUEJVbxm"}],"key":"l1xUaOAFWW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"name, df = [x for x in grouped][0]","key":"vQOT3SeYr3"},{"type":"output","id":"_iPWqAeOvKhwm455ZrH1l","data":[],"key":"th30YOa0ng"}],"key":"kSjLzO3ixx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df","key":"cQSV1OeHBA"},{"type":"output","id":"kNrQR6HcWIIK3aCTJSQ2n","data":[],"key":"eNpvZpuip1"}],"key":"H7x1gkFIwp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nconf_u = df[df['VALUE_TYPE']=='FORECAST'][['REFERENCE_PERIOD', 'CONF_LIMIT_UPPER']].rename(columns = {'CONF_LIMIT_UPPER':'POP'})\nconf_l = df[df['VALUE_TYPE']=='FORECAST'][['REFERENCE_PERIOD', 'CONF_LIMIT_LOWER']].rename(columns = {'CONF_LIMIT_LOWER':'POP'})\nconf_u = conf_u.sort_values('REFERENCE_PERIOD', ascending=False)\nconf = pd.concat([conf_u, conf_l])","key":"Iiudqb5CgD"},{"type":"output","id":"bT1YpPGVYGgmjyyOcgC27","data":[],"key":"VSFTpEs63Q"}],"key":"abg8qurKsU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import plotnine\nplot = (plotnine.ggplot()\n + plotnine.geom_path(df, plotnine.aes(x='REFERENCE_PERIOD', y='POP', color='VALUE_TYPE'))\n + plotnine.theme_bw()\n + plotnine.scale_color_manual(morpc.color.get_colors().QUAL(2).hex_list)\n + plotnine.scale_x_date(breaks='5 years', date_labels='%Y')\n + plotnine.theme(\n     axis_text_x=(plotnine.element_text(rotation=65))\n )\n + plotnine.scale_y_continuous(breaks=ybreaks, limits=(ybreaks[0], ybreaks[-1]))\n )","key":"l9XAVUeNai"},{"type":"output","id":"rXGNCehabbLGXJM6oQwhT","data":[],"key":"rsbPqg2BsK"}],"key":"Il59QjH2GN"}],"key":"FttedNrQJr"},"references":{"cite":{"order":[],"data":{}}}}